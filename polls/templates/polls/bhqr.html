<!DOCTYPE html>
<html>
<head>
    <title>QR Code Scanner</title>
    <script src="https://unpkg.com/html5-qrcode@2.0.9/dist/html5-qrcode.min.js"></script>
</head>
<body>
    <h1>QR Code Scanner</h1>
    <div id="qr-reader" style="width: 600px"></div>
    <button id="check-button">Check QR Code</button>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const checkButton = document.getElementById("check-button");
            const qrCodePopup = document.getElementById("qr-code-popup");
            const qrCodeInput = document.getElementById("qr-code-input");
            const popupResult = document.getElementById("popup-result");

            var qrCode = new Html5Qrcode("qr-reader");

            qrCode.start(
                { facingMode: "environment" },
                {
                    fps: 10,
                },
                (qrCodeMessage) => {
                    // QR 코드가 스캔될 때 호출되는 콜백 함수
                    checkButton.onclick = function () {
                        // 팝업 창을 표시
                        qrCodePopup.style.display = "block";

                        // 확인 버튼을 클릭하면 입력값과 스캔된 QR 코드를 비교
                        document.getElementById("confirm-button").onclick = function () {
                            const enteredQRCode = qrCodeInput.value;
                            if (qrCodeMessage === enteredQRCode) {
                                displayResult("O");
                            } else {
                                displayResult("X");
                            }
                        };

                        // 취소 버튼을 클릭하면 팝업 창을 닫음
                        document.getElementById("cancel-button").onclick = function () {
                            qrCodePopup.style.display = "none";
                        };
                    };
                },
                (errorMessage) => {
                    // 오류 발생 시 호출되는 콜백 함수
                    console.error(errorMessage);
                }
            });

            function displayResult(result) {
                popupResult.textContent = result;
            }
        });
    </script>
</body>
</html>
